name: Create Release on Netlify Deploy

on:
  repository_dispatch:
    types: [webhook_trigger]

jobs:
  create-release:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Get current date
      id: date
      run: echo "date=$(date +'%Y-%m-%d-%H%M%S')" >> $GITHUB_OUTPUT
      
    - name: Create Release
      env:
        GITHUB_TOKEN: ${{ secrets.PAT_TOKEN }}
      run: |
        gh release create v${{ steps.date.outputs.date }} \
          --title "Release v${{ steps.date.outputs.date }}" \
          --notes "Automated release triggered by Netlify deployment

        ## Changes
        - Latest changes deployed to production
        
        ## Deployment  
        - Successfully deployed to Netlify
        - Triggered at: ${{ steps.date.outputs.date }}"